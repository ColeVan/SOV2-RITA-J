{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "814f20a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Even More data when using the query string below and taking out http.method and http.virtual_host\n",
    "\n",
    "## s = searchContext.query('query_string', query='destination.port:*')\n",
    "\n",
    "## Empire Beacon is found at 192.168.120.158 on port 443 communicating with 192.168.128.50\n",
    "\n",
    "## However the score is only 0.685814 (See line 17) (This could be for a few reasons but still need to wait for more data collection)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "5a2e7229",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Elasticsearch connector\n",
    "from elasticsearch import Elasticsearch\n",
    "from elasticsearch_dsl import Search\n",
    "import eland as ed\n",
    "#Data manipulation\n",
    "import pandas as pd\n",
    "from pandas.io.json import json_normalize\n",
    "import json\n",
    "import re\n",
    "import eland as ed\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import math\n",
    "from datetime import datetime\n",
    "# Disable warnings\"\n",
    "import urllib3\n",
    "urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')\n",
    "warnings.simplefilter('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "736cc6e6",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ObjectApiResponse({'name': 'voodoo-onion', 'cluster_name': 'voodoo-onion', 'cluster_uuid': 'dP1VycCSTQ2EPeCVxQ25GA', 'version': {'number': '7.16.2', 'build_flavor': 'default', 'build_type': 'docker', 'build_hash': '2b937c44140b6559905130a8650c64dbd0879cfb', 'build_date': '2021-12-18T19:42:46.604893745Z', 'build_snapshot': False, 'lucene_version': '8.10.1', 'minimum_wire_compatibility_version': '6.8.0', 'minimum_index_compatibility_version': '6.0.0-beta1'}, 'tagline': 'You Know, for Search'})"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "es = Elasticsearch(['https://192.168.1.181:9200'], timeout=30, max_retries=10, retry_on_timeout=True,                  \n",
    "ca_certs=False,verify_certs=False, http_auth=('jupyter','password'))\n",
    "\n",
    "# defining the search statement to get all records in an index\n",
    "searchContext = Search(using=es, index='*:so-*', doc_type='doc')\n",
    "es.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6dfeb524",
   "metadata": {},
   "outputs": [],
   "source": [
    "query_since_ts = 0\n",
    "body_filter = '{\"query\":{\"bool\":{\"filter\":[{\"range\":{@timestamp\":{\"gt\":' + str(query_since_ts) + '}}}]}},\"sort\":[{\"@timstamp\":{\"order\":\"asc\"}}]}'\n",
    "#body_filter = '{\"query\":{\"@timestamp\":{}},\"size=10000\":[{\"@timestamp\":{\"order\":\"desc\"}}]}'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f0b7cd44",
   "metadata": {},
   "outputs": [],
   "source": [
    "#s = searchContext.query('query_string', query='message:(\"ts\" AND \"id.orig_h\" AND \"id.resp_h\" AND \"host\" AND \"id.resp_p\" AND \"method\")')\n",
    " \n",
    "s = searchContext.query('query_string', query='destination.port:*')\n",
    "\n",
    "#s = searchContext.query('query_string', query='(destination.port:\"*\" OR http.virtual_host:\"*\")')\n",
    "\n",
    "#s = searchContext.query('query_string', query='http.virtual_host:*')\n",
    "\n",
    "#s = searchContext.query('query_string', query='http.method:*')\n",
    "\n",
    "#s = searchContext.query('query_string', query='event.module:zeek')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "62427214",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "pd.set_option(\"display.max_rows\", 100)\n",
    "pd.set_option(\"max_colwidth\", 600)\n",
    "pd.set_option(\"display.max_columns\", None)\n",
    "\n",
    "\n",
    "#base response query\n",
    "#response = s.execute()\n",
    "#if response.success():\n",
    "#  df = pd.DataFrame((d.to_dict() for d in s.scan()))\n",
    "#json_struct = json.loads(df.to_json(orient=\"records\"))\n",
    "#df_flat = pd.io.json.json_normalize(json_struct)\n",
    "#df_flat.head(20)\n",
    "\n",
    "#response = s.execute()\n",
    "#if response.success():\n",
    "    #df = pd.DataFrame(([d['@timestamp'], d['source']['ip'], d['destination']['ip'], d['http']['virtual_host'], d['destination']['port'], d['http']['method']] for d in s))\n",
    "#df.columns=['Timestamp','Source.ip','Destination.ip','Host','Destination.port','Method']    \n",
    "#df.astype({'Destination.Port': 'int64'})\n",
    "#display(df)\n",
    "#df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "1e04e198",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ts</th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2021-12-29T22:25:30.117Z</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2021-12-29T22:23:29.880Z</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2021-12-29T22:21:29.647Z</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2021-12-29T22:19:29.627Z</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2021-12-29T22:17:29.393Z</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9995</th>\n",
       "      <td>2021-12-29T22:10:20.137Z</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>137</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9996</th>\n",
       "      <td>2021-12-29T22:10:32.145Z</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>224.0.0.251</td>\n",
       "      <td>5353</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9997</th>\n",
       "      <td>2021-12-29T22:10:49.344Z</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>137</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9998</th>\n",
       "      <td>2021-12-29T22:10:03.629Z</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>224.0.0.251</td>\n",
       "      <td>5353</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9999</th>\n",
       "      <td>2021-12-29T22:10:20.883Z</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>137</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10000 rows Ã— 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                            ts       source.ip   destination.ip  \\\n",
       "0     2021-12-29T22:25:30.117Z  192.168.128.50  192.168.120.158   \n",
       "1     2021-12-29T22:23:29.880Z  192.168.128.50  192.168.120.158   \n",
       "2     2021-12-29T22:21:29.647Z  192.168.128.50  192.168.120.158   \n",
       "3     2021-12-29T22:19:29.627Z  192.168.128.50  192.168.120.158   \n",
       "4     2021-12-29T22:17:29.393Z  192.168.128.50  192.168.120.158   \n",
       "...                        ...             ...              ...   \n",
       "9995  2021-12-29T22:10:20.137Z   192.168.1.220    192.168.1.255   \n",
       "9996  2021-12-29T22:10:32.145Z   192.168.1.220      224.0.0.251   \n",
       "9997  2021-12-29T22:10:49.344Z   192.168.1.220    192.168.1.255   \n",
       "9998  2021-12-29T22:10:03.629Z   192.168.1.220      224.0.0.251   \n",
       "9999  2021-12-29T22:10:20.883Z   192.168.1.220    192.168.1.255   \n",
       "\n",
       "     destination.port  \n",
       "0                 443  \n",
       "1                 443  \n",
       "2                 443  \n",
       "3                 443  \n",
       "4                 443  \n",
       "...               ...  \n",
       "9995              137  \n",
       "9996             5353  \n",
       "9997              137  \n",
       "9998             5353  \n",
       "9999              137  \n",
       "\n",
       "[10000 rows x 4 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 10000 entries, 0 to 9999\n",
      "Data columns (total 4 columns):\n",
      " #   Column            Non-Null Count  Dtype \n",
      "---  ------            --------------  ----- \n",
      " 0   ts                10000 non-null  object\n",
      " 1   source.ip         10000 non-null  object\n",
      " 2   destination.ip    10000 non-null  object\n",
      " 3   destination.port  10000 non-null  object\n",
      "dtypes: object(4)\n",
      "memory usage: 312.6+ KB\n"
     ]
    }
   ],
   "source": [
    "response = s.execute()\n",
    "df = pd.DataFrame(columns=['ts','source.ip','destination.ip','destination.port'])\n",
    "if response.success():\n",
    "    for d in s[:10000]:\n",
    "        try:\n",
    "            df = df.append({'ts' : d['@timestamp'], 'source.ip' : d['source']['ip'], 'destination.ip' : d['destination']['ip'], 'destination.port': d['destination']['port']}, ignore_index=True)\n",
    "        except KeyError:\n",
    "            pass\n",
    "            \n",
    "#response = s.execute()\n",
    "#if response.success():\n",
    "#    df = pd.DataFrame(([d['@timestamp'], d['source']['ip'], d['destination']['ip'], d['http']['virtual_host'], d['destination']['port'], d['http']['method']] for d in s))\n",
    "#df.columns=['Timestamp','Source.ip','Destination.ip','Host','Destination.port','Method']    \n",
    "#df.astype({'Destination.Port': 'int64'})\n",
    "\n",
    "display(df)\n",
    "\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f7ad01ba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ts</th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2021-12-29 22:25:30.117000+00:00</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2021-12-29 22:23:29.880000+00:00</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2021-12-29 22:21:29.647000+00:00</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2021-12-29 22:19:29.627000+00:00</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2021-12-29 22:17:29.393000+00:00</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                ts       source.ip   destination.ip  \\\n",
       "0 2021-12-29 22:25:30.117000+00:00  192.168.128.50  192.168.120.158   \n",
       "1 2021-12-29 22:23:29.880000+00:00  192.168.128.50  192.168.120.158   \n",
       "2 2021-12-29 22:21:29.647000+00:00  192.168.128.50  192.168.120.158   \n",
       "3 2021-12-29 22:19:29.627000+00:00  192.168.128.50  192.168.120.158   \n",
       "4 2021-12-29 22:17:29.393000+00:00  192.168.128.50  192.168.120.158   \n",
       "\n",
       "  destination.port  \n",
       "0              443  \n",
       "1              443  \n",
       "2              443  \n",
       "3              443  \n",
       "4              443  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['ts'] = pd.to_datetime(df['ts'],infer_datetime_format=True)\n",
    "df.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1ca4c85d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# assign field/column names to variables\n",
    "f_timestamp = 'ts'\n",
    "f_src_ip = 'source.ip'\n",
    "f_dst_ip = 'destination.ip'\n",
    "f_dst_port = 'destination.port'\n",
    "f_delimiter = '\\t'\n",
    "\n",
    "columns_to_filter = [f_timestamp, f_src_ip, f_dst_ip, f_dst_port,]\n",
    "columns_to_groupby = [f_src_ip, f_dst_ip, f_dst_port,]\n",
    "# columns to display after the analysis\n",
    "columns_to_display = ['tsScore','conn_count',f_src_ip,f_dst_ip,f_dst_port,'deltas']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "55f87532",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>ts</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">0.0.0.0</th>\n",
       "      <th rowspan=\"2\" valign=\"top\">255.255.255.255</th>\n",
       "      <th>67</th>\n",
       "      <td>[2021-12-29 21:29:24.198000+00:00, 2021-12-29 22:02:46.480000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67</th>\n",
       "      <td>[2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0:0:0:0:0:0:0:1</th>\n",
       "      <th>0:0:0:0:0:0:0:1</th>\n",
       "      <th>5985</th>\n",
       "      <td>[2021-12-29 19:18:53.532000+00:00, 2021-12-29 19:18:53.530000+00:00, 2021-12-29 19:18:52.771000+00:00, 2021-12-29 19:18:52.771000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"6\" valign=\"top\">127.0.0.1</th>\n",
       "      <th rowspan=\"6\" valign=\"top\">127.0.0.1</th>\n",
       "      <th>4506</th>\n",
       "      <td>[2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.810000+00:00, 2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.811000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47660</th>\n",
       "      <td>[2021-12-29 20:38:42.776000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47761</th>\n",
       "      <td>[2021-12-29 20:38:42.805000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47762</th>\n",
       "      <td>[2021-12-29 20:38:42.805000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47763</th>\n",
       "      <td>[2021-12-29 20:38:42.805000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 17:49:57+00:00, 2021-12-29 17:49:57+00:00, 2021-12-29 17:49:57+00:00, 2021-12-29 17:49:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:42+00:00, 2021-12-29 17:39:42+00:00, 2021-12-29 17:39:42+00:00, 2021-12-29 17:39:42+00:00, 2...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"41\" valign=\"top\">192.168.1.154</th>\n",
       "      <th>104.18.24.243</th>\n",
       "      <th>80</th>\n",
       "      <td>[2021-12-29 16:55:51+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104.46.162.226</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 21:23:37.944000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">104.47.2.8</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 21:45:50.065000+00:00, 2021-12-29 21:45:52.180000+00:00, 2021-12-29 21:45:52.180000+00:00, 2021-12-29 21:53:29.622000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:53:19+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">104.47.38.8</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 22:16:39.105000+00:00, 2021-12-29 21:43:49.193000+00:00, 2021-12-29 21:45:51.820000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:59:38+00:00, 2021-12-29 17:16:39+00:00, 2021-12-29 17:10:46+00:00, 2021-12-29 16:53:27+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">104.47.40.8</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 20:43:22.754000+00:00, 2021-12-29 21:53:27.002000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:52:38+00:00, 2021-12-29 16:55:50+00:00, 2021-12-29 16:53:27+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104.80.74.140</th>\n",
       "      <th>80</th>\n",
       "      <td>[2021-12-29 16:59:28+00:00, 2021-12-29 17:21:51+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">108.162.193.219</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 21:59:27.523000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:59:27+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108.177.122.94</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 16:53:17+00:00, 2021-12-29 17:23:19+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.160.4</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 21:51:22.953000+00:00, 2021-12-29 21:53:20.584000+00:00, 2021-12-29 21:59:37.968000+00:00, 2021-12-29 21:59:37.968000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 17:42:06+00:00, 2021-12-29 17:42:06+00:00, 2021-12-29 17:29:46+00:00, 2021-12-29 16:59:38+00:00, 2021-12-29 16:58:27+00:00, 2021-12-29 17:09:11+00:00, 2021-12-29 16:53:21+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.21.200</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 20:45:47.671000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 16:54:15+00:00, 2021-12-29 16:54:14+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.222.240</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 22:22:00.784000+00:00, 2021-12-29 22:21:59.528000+00:00, 2021-12-29 22:20:50.920000+00:00, 2021-12-29 22:24:25.791000+00:00, 2021-12-29 22:38:56.907000+00:00, 2021-12-29 22:41:17.030000+00:00, 2021-12-29 22:42:05.834000+00:00, 2021-12-29 22:43:42.180000+00:00, 2021-12-29 22:46:30.090000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 17:51:59+00:00, 2021-12-29 17:42:06+00:00, 2021-12-29 17:42:06+00:00, 2021-12-29 17:41:17+00:00, 2021-12-29 17:41:02+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:30:46+00:00, 2021-12-29 17:30:07+00:00, 2021-12-29 17:29:46+00:00, 2021-12-29 17:29:46+00:00, 2021-12-29 17:20:52+00:00, 2021-12-29 17:20:52+00:00, 2021-12-29 17:20:52+00:00, 2021-12-29 17:20:51+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:06:34+00:00, 2021-12-29 17:04:07+00:00, 2021-12-29 17:03:37+00:00, 2021-12-29 17:03:36+00:00, 2021-12-29 17:03:33+00:00, 2021-12-29 17:03:32+00:00, 2021-12-29 17:03:32+00:00, 2...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.246.2</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:55:50+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.246.254</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 16:55:50+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.3.1</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:53:27+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.3.2</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 17:10:46+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.4.2</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 20:55:47.709000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:53:19+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.4.52</th>\n",
       "      <th>80</th>\n",
       "      <td>[2021-12-29 21:53:18.900000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>[2021-12-29 16:53:19+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.42.1</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 17:22:01+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.42.16</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 17:22:01+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.42.2</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:55:50+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.42.254</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 21:55:50.135000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 16:55:50+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.6.1</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 21:53:29.205000+00:00, 2021-12-29 21:53:30.241000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:29+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.107.6.163</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 21:45:52.977000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 16:53:30+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.107.6.2</th>\n",
       "      <th>53</th>\n",
       "      <td>[2021-12-29 21:45:50.229000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13.68.233.9</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 16:53:31+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.78.111.198</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 21:38:57.506000+00:00, 2021-12-29 21:38:57.163000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 17:22:00+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">13.89.178.27</th>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 20:51:59.612000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>443</th>\n",
       "      <td>[2021-12-29 17:11:02+00:00]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ts\n",
       "source.ip       destination.ip  destination.port                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \n",
       "0.0.0.0         255.255.255.255 67                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   [2021-12-29 21:29:24.198000+00:00, 2021-12-29 22:02:46.480000+00:00]\n",
       "                                67                                                                                                                                                                                                                                                                                                                                                                                                               [2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00]\n",
       "0:0:0:0:0:0:0:1 0:0:0:0:0:0:0:1 5985                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             [2021-12-29 19:18:53.532000+00:00, 2021-12-29 19:18:53.530000+00:00, 2021-12-29 19:18:52.771000+00:00, 2021-12-29 19:18:52.771000+00:00]\n",
       "127.0.0.1       127.0.0.1       4506                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             [2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.810000+00:00, 2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.811000+00:00]\n",
       "                                47660                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [2021-12-29 20:38:42.776000+00:00]\n",
       "                                47761                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [2021-12-29 20:38:42.805000+00:00]\n",
       "                                47762                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [2021-12-29 20:38:42.805000+00:00]\n",
       "                                47763                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [2021-12-29 20:38:42.805000+00:00]\n",
       "                                53                [2021-12-29 17:49:57+00:00, 2021-12-29 17:49:57+00:00, 2021-12-29 17:49:57+00:00, 2021-12-29 17:49:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:43+00:00, 2021-12-29 17:39:42+00:00, 2021-12-29 17:39:42+00:00, 2021-12-29 17:39:42+00:00, 2021-12-29 17:39:42+00:00, 2...\n",
       "192.168.1.154   104.18.24.243   80                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 16:55:51+00:00]\n",
       "                104.46.162.226  443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [2021-12-29 21:23:37.944000+00:00]\n",
       "                104.47.2.8      53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               [2021-12-29 21:45:50.065000+00:00, 2021-12-29 21:45:52.180000+00:00, 2021-12-29 21:45:52.180000+00:00, 2021-12-29 21:53:29.622000+00:00]\n",
       "                                53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [2021-12-29 16:53:19+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00]\n",
       "                104.47.38.8     53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 [2021-12-29 22:16:39.105000+00:00, 2021-12-29 21:43:49.193000+00:00, 2021-12-29 21:45:51.820000+00:00]\n",
       "                                53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 16:59:38+00:00, 2021-12-29 17:16:39+00:00, 2021-12-29 17:10:46+00:00, 2021-12-29 16:53:27+00:00]\n",
       "                104.47.40.8     53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   [2021-12-29 20:43:22.754000+00:00, 2021-12-29 21:53:27.002000+00:00]\n",
       "                                53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [2021-12-29 16:52:38+00:00, 2021-12-29 16:55:50+00:00, 2021-12-29 16:53:27+00:00]\n",
       "                104.80.74.140   80                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 [2021-12-29 16:59:28+00:00, 2021-12-29 17:21:51+00:00]\n",
       "                108.162.193.219 53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [2021-12-29 21:59:27.523000+00:00]\n",
       "                                53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 16:59:27+00:00]\n",
       "                108.177.122.94  443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [2021-12-29 16:53:17+00:00, 2021-12-29 17:23:19+00:00]\n",
       "                13.107.160.4    53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               [2021-12-29 21:51:22.953000+00:00, 2021-12-29 21:53:20.584000+00:00, 2021-12-29 21:59:37.968000+00:00, 2021-12-29 21:59:37.968000+00:00]\n",
       "                                53                                                                                                                                                                                                                                                                                                                                                                                                                                          [2021-12-29 17:42:06+00:00, 2021-12-29 17:42:06+00:00, 2021-12-29 17:29:46+00:00, 2021-12-29 16:59:38+00:00, 2021-12-29 16:58:27+00:00, 2021-12-29 17:09:11+00:00, 2021-12-29 16:53:21+00:00]\n",
       "                13.107.21.200   443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [2021-12-29 20:45:47.671000+00:00]\n",
       "                                443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [2021-12-29 16:54:15+00:00, 2021-12-29 16:54:14+00:00]\n",
       "                13.107.222.240  53                [2021-12-29 22:22:00.784000+00:00, 2021-12-29 22:21:59.528000+00:00, 2021-12-29 22:20:50.920000+00:00, 2021-12-29 22:24:25.791000+00:00, 2021-12-29 22:38:56.907000+00:00, 2021-12-29 22:41:17.030000+00:00, 2021-12-29 22:42:05.834000+00:00, 2021-12-29 22:43:42.180000+00:00, 2021-12-29 22:46:30.090000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:...\n",
       "                                53                [2021-12-29 17:51:59+00:00, 2021-12-29 17:42:06+00:00, 2021-12-29 17:42:06+00:00, 2021-12-29 17:41:17+00:00, 2021-12-29 17:41:02+00:00, 2021-12-29 17:39:57+00:00, 2021-12-29 17:30:46+00:00, 2021-12-29 17:30:07+00:00, 2021-12-29 17:29:46+00:00, 2021-12-29 17:29:46+00:00, 2021-12-29 17:20:52+00:00, 2021-12-29 17:20:52+00:00, 2021-12-29 17:20:52+00:00, 2021-12-29 17:20:51+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:06:34+00:00, 2021-12-29 17:04:07+00:00, 2021-12-29 17:03:37+00:00, 2021-12-29 17:03:36+00:00, 2021-12-29 17:03:33+00:00, 2021-12-29 17:03:32+00:00, 2021-12-29 17:03:32+00:00, 2...\n",
       "                13.107.246.2    53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 16:55:50+00:00]\n",
       "                13.107.246.254  443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 16:55:50+00:00]\n",
       "                13.107.3.1      53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 16:53:27+00:00]\n",
       "                13.107.3.2      53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 17:10:46+00:00]\n",
       "                13.107.4.2      53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [2021-12-29 20:55:47.709000+00:00]\n",
       "                                53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 16:53:19+00:00]\n",
       "                13.107.4.52     80                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [2021-12-29 21:53:18.900000+00:00]\n",
       "                                80                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 16:53:19+00:00]\n",
       "                13.107.42.1     53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 17:22:01+00:00]\n",
       "                13.107.42.16    443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 17:22:01+00:00]\n",
       "                13.107.42.2     53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [2021-12-29 16:55:50+00:00]\n",
       "                13.107.42.254   443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [2021-12-29 21:55:50.135000+00:00]\n",
       "                                443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 16:55:50+00:00]\n",
       "                13.107.6.1      53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   [2021-12-29 21:53:29.205000+00:00, 2021-12-29 21:53:30.241000+00:00]\n",
       "                                53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:29+00:00]\n",
       "                13.107.6.163    443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [2021-12-29 21:45:52.977000+00:00]\n",
       "                                443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 16:53:30+00:00]\n",
       "                13.107.6.2      53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [2021-12-29 21:45:50.229000+00:00]\n",
       "                13.68.233.9     443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 16:53:31+00:00]\n",
       "                13.78.111.198   443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [2021-12-29 21:38:57.506000+00:00, 2021-12-29 21:38:57.163000+00:00]\n",
       "                                443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 17:22:00+00:00]\n",
       "                13.89.178.27    443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [2021-12-29 20:51:59.612000+00:00]\n",
       "                                443                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [2021-12-29 17:11:02+00:00]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# If you have a large dateset, using groupby and aggregate(list) might be slow. Consider using dask\n",
    "df = df.groupby(columns_to_groupby).agg(list)\n",
    "df.head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "74f0b101",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th>ts</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.0.0.0</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>67</td>\n",
       "      <td>[2021-12-29 21:29:24.198000+00:00, 2021-12-29 22:02:46.480000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.0.0.0</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>67</td>\n",
       "      <td>[2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0:0:0:0:0:0:0:1</td>\n",
       "      <td>0:0:0:0:0:0:0:1</td>\n",
       "      <td>5985</td>\n",
       "      <td>[2021-12-29 19:18:53.532000+00:00, 2021-12-29 19:18:53.530000+00:00, 2021-12-29 19:18:52.771000+00:00, 2021-12-29 19:18:52.771000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>4506</td>\n",
       "      <td>[2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.810000+00:00, 2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.811000+00:00]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>47660</td>\n",
       "      <td>[2021-12-29 20:38:42.776000+00:00]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         source.ip   destination.ip destination.port  \\\n",
       "0          0.0.0.0  255.255.255.255               67   \n",
       "1          0.0.0.0  255.255.255.255               67   \n",
       "2  0:0:0:0:0:0:0:1  0:0:0:0:0:0:0:1             5985   \n",
       "3        127.0.0.1        127.0.0.1             4506   \n",
       "4        127.0.0.1        127.0.0.1            47660   \n",
       "\n",
       "                                                                                                                                                                                                                         ts  \n",
       "0                                                                                                                                                      [2021-12-29 21:29:24.198000+00:00, 2021-12-29 22:02:46.480000+00:00]  \n",
       "1  [2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00]  \n",
       "2                                                                                  [2021-12-29 19:18:53.532000+00:00, 2021-12-29 19:18:53.530000+00:00, 2021-12-29 19:18:52.771000+00:00, 2021-12-29 19:18:52.771000+00:00]  \n",
       "3                                                                                  [2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.810000+00:00, 2021-12-29 20:38:42.772000+00:00, 2021-12-29 20:38:42.811000+00:00]  \n",
       "4                                                                                                                                                                                        [2021-12-29 20:38:42.776000+00:00]  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.reset_index(inplace=True)\n",
    "df.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "5f0e12f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th>ts</th>\n",
       "      <th>conn_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.0.0.0</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>67</td>\n",
       "      <td>[2021-12-29 21:29:24.198000+00:00, 2021-12-29 22:02:46.480000+00:00]</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.0.0.0</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>67</td>\n",
       "      <td>[2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00]</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  source.ip   destination.ip destination.port  \\\n",
       "0   0.0.0.0  255.255.255.255               67   \n",
       "1   0.0.0.0  255.255.255.255               67   \n",
       "\n",
       "                                                                                                                                                                                                                         ts  \\\n",
       "0                                                                                                                                                      [2021-12-29 21:29:24.198000+00:00, 2021-12-29 22:02:46.480000+00:00]   \n",
       "1  [2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00, 2021-12-29 17:02:46+00:00]   \n",
       "\n",
       "   conn_count  \n",
       "0           2  \n",
       "1           8  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# create a new column 'conn_count', and for each row in the 'ts' column, apply a function and assign the returned value to the 'conn_count' column\n",
    "df['conn_count'] = df[f_timestamp].apply(lambda x: len(x))\n",
    "df.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "14c69bd1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(69, 5)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Filter out traffic where the connection count is quite small\n",
    "df = df.loc[df['conn_count'] > 10]\n",
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "bcd4cd05",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th>ts</th>\n",
       "      <th>conn_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2...</td>\n",
       "      <td>108</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>13.107.222.240</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 20:06:33.822000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:28:05.028000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:46:29.435000+00:00, 2021-12-29 20:51:59.509000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:54:47.414000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:58:49.479000+00:00, 2021-12-29 21:06:...</td>\n",
       "      <td>47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>13.107.222.240</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 16:51:59+00:00, 2021-12-29 16:52:38+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:20+00:00, 2021-12-29 16:53:21+00:00, 2021-12-29 16:53:22+00:00, 2021-12-29 16:53:27+00:00, 2021-12-29 16:53:29+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:54:15+00:00, 2021-12-29 16:54:19+00:00, 2021-12-29 16:55:03+00:00, 2021-12-29 16:55:27+00:00, 2021-12-29 16:56:14+00:00, 2...</td>\n",
       "      <td>79</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>184.85.168.170</td>\n",
       "      <td>443</td>\n",
       "      <td>[2021-12-29 21:53:21.889000+00:00, 2021-12-29 21:53:24.004000+00:00, 2021-12-29 21:53:24.338000+00:00, 2021-12-29 21:53:24.374000+00:00, 2021-12-29 21:53:24.547000+00:00, 2021-12-29 22:03:36.423000+00:00, 2021-12-29 22:05:45.642000+00:00, 2021-12-29 22:18:40.492000+00:00, 2021-12-29 22:18:40.492000+00:00, 2021-12-29 22:18:40.497000+00:00, 2021-12-29 22:18:40.498000+00:00, 2021-12-29 22:18:40.530000+00:00, 2021-12-29 22:18:40.539000+00:00]</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>184.85.168.170</td>\n",
       "      <td>443</td>\n",
       "      <td>[2021-12-29 16:53:22+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 17:03:36+00:00, 2021-12-29 17:03:36+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2...</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        source.ip  destination.ip destination.port  \\\n",
       "8       127.0.0.1       127.0.0.1               53   \n",
       "25  192.168.1.154  13.107.222.240               53   \n",
       "26  192.168.1.154  13.107.222.240               53   \n",
       "85  192.168.1.154  184.85.168.170              443   \n",
       "86  192.168.1.154  184.85.168.170              443   \n",
       "\n",
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ts  \\\n",
       "8   [2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2...   \n",
       "25  [2021-12-29 20:06:33.822000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:28:05.028000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:46:29.435000+00:00, 2021-12-29 20:51:59.509000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:54:47.414000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:58:49.479000+00:00, 2021-12-29 21:06:...   \n",
       "26  [2021-12-29 16:51:59+00:00, 2021-12-29 16:52:38+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:20+00:00, 2021-12-29 16:53:21+00:00, 2021-12-29 16:53:22+00:00, 2021-12-29 16:53:27+00:00, 2021-12-29 16:53:29+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:54:15+00:00, 2021-12-29 16:54:19+00:00, 2021-12-29 16:55:03+00:00, 2021-12-29 16:55:27+00:00, 2021-12-29 16:56:14+00:00, 2...   \n",
       "85                                                                                                                                                               [2021-12-29 21:53:21.889000+00:00, 2021-12-29 21:53:24.004000+00:00, 2021-12-29 21:53:24.338000+00:00, 2021-12-29 21:53:24.374000+00:00, 2021-12-29 21:53:24.547000+00:00, 2021-12-29 22:03:36.423000+00:00, 2021-12-29 22:05:45.642000+00:00, 2021-12-29 22:18:40.492000+00:00, 2021-12-29 22:18:40.492000+00:00, 2021-12-29 22:18:40.497000+00:00, 2021-12-29 22:18:40.498000+00:00, 2021-12-29 22:18:40.530000+00:00, 2021-12-29 22:18:40.539000+00:00]   \n",
       "86  [2021-12-29 16:53:22+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 16:53:24+00:00, 2021-12-29 17:03:36+00:00, 2021-12-29 17:03:36+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2021-12-29 17:18:40+00:00, 2...   \n",
       "\n",
       "    conn_count  \n",
       "8          108  \n",
       "25          47  \n",
       "26          79  \n",
       "85          13  \n",
       "86          28  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[f_timestamp] = df[f_timestamp].apply(lambda x: sorted(x))\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "829d02fe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th>ts</th>\n",
       "      <th>conn_count</th>\n",
       "      <th>deltas</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2...</td>\n",
       "      <td>108</td>\n",
       "      <td>[0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 284.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 300.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>13.107.222.240</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 20:06:33.822000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:28:05.028000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:46:29.435000+00:00, 2021-12-29 20:51:59.509000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:54:47.414000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:58:49.479000+00:00, 2021-12-29 21:06:...</td>\n",
       "      <td>47</td>\n",
       "      <td>[142.0, 782.0, 365.0, 651.0, 187.0, 78.0, 0.0, 185.0, 330.0, 143.0, 24.0, 15.0, 0.0, 44.0, 0.0, 181.0, 459.0, 0.0, 4.0, 1023.0, 33.0, 334.0, 869.0, 134.0, 15.0, 393.0, 2.0, 9.0, 44.0, 119.0, 132.0, 292.0, 1.0, 11.0, 4.0, 30.0, 304.0, 699.0, 68.0, 1.0, 145.0, 871.0, 140.0, 48.0, 96.0, 167.0]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        source.ip  destination.ip destination.port  \\\n",
       "8       127.0.0.1       127.0.0.1               53   \n",
       "25  192.168.1.154  13.107.222.240               53   \n",
       "\n",
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ts  \\\n",
       "8   [2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2...   \n",
       "25  [2021-12-29 20:06:33.822000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:28:05.028000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:46:29.435000+00:00, 2021-12-29 20:51:59.509000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:54:47.414000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:58:49.479000+00:00, 2021-12-29 21:06:...   \n",
       "\n",
       "    conn_count  \\\n",
       "8          108   \n",
       "25          47   \n",
       "\n",
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              deltas  \n",
       "8   [0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 284.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 300.0, ...]  \n",
       "25                                                                                                                                                                                                                                               [142.0, 782.0, 365.0, 651.0, 187.0, 78.0, 0.0, 185.0, 330.0, 143.0, 24.0, 15.0, 0.0, 44.0, 0.0, 181.0, 459.0, 0.0, 4.0, 1023.0, 33.0, 334.0, 869.0, 134.0, 15.0, 393.0, 2.0, 9.0, 44.0, 119.0, 132.0, 292.0, 1.0, 11.0, 4.0, 30.0, 304.0, 699.0, 68.0, 1.0, 145.0, 871.0, 140.0, 48.0, 96.0, 167.0]  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Convert list into a Series object, get time delta, convert the result back into a list and assign it to the 'deltas' column\n",
    "df['deltas'] = df[f_timestamp].apply(lambda x: pd.Series(x).diff().dt.seconds.dropna().tolist())\n",
    "df.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "f6633f1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['tsLow'] = df['deltas'].apply(lambda x: np.percentile(np.array(x), 20))\n",
    "df['tsMid'] = df['deltas'].apply(lambda x: np.percentile(np.array(x), 50))\n",
    "df['tsHigh'] = df['deltas'].apply(lambda x: np.percentile(np.array(x), 80))\n",
    "df['tsBowleyNum'] = df['tsLow'] + df['tsHigh'] - 2*df['tsMid']\n",
    "df['tsBowleyDen'] = df['tsHigh'] - df['tsLow']\n",
    "df['tsSkew'] = df[['tsLow','tsMid','tsHigh','tsBowleyNum','tsBowleyDen']].apply(\n",
    "    lambda x: x['tsBowleyNum'] / x['tsBowleyDen'] if x['tsBowleyDen'] != 0 and x['tsMid'] != x['tsLow'] and x['tsMid'] != x['tsHigh'] else 0.0, axis=1\n",
    "    )\n",
    "df['tsMadm'] = df['deltas'].apply(lambda x: np.median(np.absolute(np.array(x) - np.median(np.array(x)))))\n",
    "df['tsConnDiv'] = df[f_timestamp].apply(lambda x: (x[-1].to_pydatetime() - x[0].to_pydatetime()).seconds / 10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "b32d7d36",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th>ts</th>\n",
       "      <th>conn_count</th>\n",
       "      <th>deltas</th>\n",
       "      <th>tsLow</th>\n",
       "      <th>tsMid</th>\n",
       "      <th>tsHigh</th>\n",
       "      <th>tsBowleyNum</th>\n",
       "      <th>tsBowleyDen</th>\n",
       "      <th>tsSkew</th>\n",
       "      <th>tsMadm</th>\n",
       "      <th>tsConnDiv</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2...</td>\n",
       "      <td>108</td>\n",
       "      <td>[0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 284.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 300.0, ...]</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>330.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>13.107.222.240</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 20:06:33.822000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:28:05.028000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:46:29.435000+00:00, 2021-12-29 20:51:59.509000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:54:47.414000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:58:49.479000+00:00, 2021-12-29 21:06:...</td>\n",
       "      <td>47</td>\n",
       "      <td>[142.0, 782.0, 365.0, 651.0, 187.0, 78.0, 0.0, 185.0, 330.0, 143.0, 24.0, 15.0, 0.0, 44.0, 0.0, 181.0, 459.0, 0.0, 4.0, 1023.0, 33.0, 334.0, 869.0, 134.0, 15.0, 393.0, 2.0, 9.0, 44.0, 119.0, 132.0, 292.0, 1.0, 11.0, 4.0, 30.0, 304.0, 699.0, 68.0, 1.0, 145.0, 871.0, 140.0, 48.0, 96.0, 167.0]</td>\n",
       "      <td>9.0</td>\n",
       "      <td>125.5</td>\n",
       "      <td>334.0</td>\n",
       "      <td>92.0</td>\n",
       "      <td>325.0</td>\n",
       "      <td>0.283077</td>\n",
       "      <td>115.5</td>\n",
       "      <td>959.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>13.107.222.240</td>\n",
       "      <td>53</td>\n",
       "      <td>[2021-12-29 16:51:59+00:00, 2021-12-29 16:52:38+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:20+00:00, 2021-12-29 16:53:21+00:00, 2021-12-29 16:53:22+00:00, 2021-12-29 16:53:27+00:00, 2021-12-29 16:53:29+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:54:15+00:00, 2021-12-29 16:54:19+00:00, 2021-12-29 16:55:03+00:00, 2021-12-29 16:55:27+00:00, 2021-12-29 16:56:14+00:00, 2...</td>\n",
       "      <td>79</td>\n",
       "      <td>[39.0, 41.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 5.0, 2.0, 1.0, 0.0, 1.0, 0.0, 8.0, 0.0, 36.0, 4.0, 44.0, 24.0, 47.0, 133.0, 71.0, 8.0, 56.0, 32.0, 42.0, 84.0, 0.0, 1.0, 11.0, 0.0, 1.0, 3.0, 1.0, 30.0, 147.0, 106.0, 51.0, 95.0, 1.0, 15.0, 29.0, 1.0, 32.0, 1.0, 131.0, 134.0, 9.0, 0.0, 121.0, 131.0, 1.0, 0.0, 0.0, 67.0, 2.0, 0.0, 21.0, 123.0, 1.0, 37.0, 283.0, 0.0, 21.0, 39.0, 348.0, 143.0, 15.0, 45.0, 65.0, 15.0, 49.0, 0.0, 96.0, 34.0, 134.0, 329.0]</td>\n",
       "      <td>1.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>78.8</td>\n",
       "      <td>43.8</td>\n",
       "      <td>77.8</td>\n",
       "      <td>0.562982</td>\n",
       "      <td>18.0</td>\n",
       "      <td>360.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        source.ip  destination.ip destination.port  \\\n",
       "8       127.0.0.1       127.0.0.1               53   \n",
       "25  192.168.1.154  13.107.222.240               53   \n",
       "26  192.168.1.154  13.107.222.240               53   \n",
       "\n",
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ts  \\\n",
       "8   [2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:54:57+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:52+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:54+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2021-12-29 16:56:55+00:00, 2...   \n",
       "25  [2021-12-29 20:06:33.822000+00:00, 2021-12-29 20:08:56.707000+00:00, 2021-12-29 20:21:59.674000+00:00, 2021-12-29 20:28:05.028000+00:00, 2021-12-29 20:38:56.732000+00:00, 2021-12-29 20:42:04.614000+00:00, 2021-12-29 20:43:22.882000+00:00, 2021-12-29 20:43:23.794000+00:00, 2021-12-29 20:46:29.435000+00:00, 2021-12-29 20:51:59.509000+00:00, 2021-12-29 20:54:22.721000+00:00, 2021-12-29 20:54:47.414000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:02.959000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:55:47.666000+00:00, 2021-12-29 20:58:49.479000+00:00, 2021-12-29 21:06:...   \n",
       "26  [2021-12-29 16:51:59+00:00, 2021-12-29 16:52:38+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:19+00:00, 2021-12-29 16:53:20+00:00, 2021-12-29 16:53:21+00:00, 2021-12-29 16:53:22+00:00, 2021-12-29 16:53:27+00:00, 2021-12-29 16:53:29+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:30+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:31+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:53:39+00:00, 2021-12-29 16:54:15+00:00, 2021-12-29 16:54:19+00:00, 2021-12-29 16:55:03+00:00, 2021-12-29 16:55:27+00:00, 2021-12-29 16:56:14+00:00, 2...   \n",
       "\n",
       "    conn_count  \\\n",
       "8          108   \n",
       "25          47   \n",
       "26          79   \n",
       "\n",
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              deltas  \\\n",
       "8   [0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 284.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 300.0, ...]   \n",
       "25                                                                                                                                                                                                                                               [142.0, 782.0, 365.0, 651.0, 187.0, 78.0, 0.0, 185.0, 330.0, 143.0, 24.0, 15.0, 0.0, 44.0, 0.0, 181.0, 459.0, 0.0, 4.0, 1023.0, 33.0, 334.0, 869.0, 134.0, 15.0, 393.0, 2.0, 9.0, 44.0, 119.0, 132.0, 292.0, 1.0, 11.0, 4.0, 30.0, 304.0, 699.0, 68.0, 1.0, 145.0, 871.0, 140.0, 48.0, 96.0, 167.0]   \n",
       "26                                                                                    [39.0, 41.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 5.0, 2.0, 1.0, 0.0, 1.0, 0.0, 8.0, 0.0, 36.0, 4.0, 44.0, 24.0, 47.0, 133.0, 71.0, 8.0, 56.0, 32.0, 42.0, 84.0, 0.0, 1.0, 11.0, 0.0, 1.0, 3.0, 1.0, 30.0, 147.0, 106.0, 51.0, 95.0, 1.0, 15.0, 29.0, 1.0, 32.0, 1.0, 131.0, 134.0, 9.0, 0.0, 121.0, 131.0, 1.0, 0.0, 0.0, 67.0, 2.0, 0.0, 21.0, 123.0, 1.0, 37.0, 283.0, 0.0, 21.0, 39.0, 348.0, 143.0, 15.0, 45.0, 65.0, 15.0, 49.0, 0.0, 96.0, 34.0, 134.0, 329.0]   \n",
       "\n",
       "    tsLow  tsMid  tsHigh  tsBowleyNum  tsBowleyDen    tsSkew  tsMadm  \\\n",
       "8     0.0    0.0     0.0          0.0          0.0  0.000000     0.0   \n",
       "25    9.0  125.5   334.0         92.0        325.0  0.283077   115.5   \n",
       "26    1.0   18.0    78.8         43.8         77.8  0.562982    18.0   \n",
       "\n",
       "    tsConnDiv  \n",
       "8       330.0  \n",
       "25      959.6  \n",
       "26      360.0  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "693a9fab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tsScore</th>\n",
       "      <th>conn_count</th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th>deltas</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>24</td>\n",
       "      <td>192.168.1.202</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>56700</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>31</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>8.240.196.126</td>\n",
       "      <td>80</td>\n",
       "      <td>[0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>24</td>\n",
       "      <td>192.168.1.202</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>9999</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>38</td>\n",
       "      <td>192.168.128.15</td>\n",
       "      <td>23.66.101.177</td>\n",
       "      <td>80</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>26</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>8.240.196.126</td>\n",
       "      <td>80</td>\n",
       "      <td>[0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0.822222</td>\n",
       "      <td>2817</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>137</td>\n",
       "      <td>[1.0, 0.0, 1.0, 1.0, 1.0, 6.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 11.0, 3.0, 0.0, 0.0, 5.0, 6.0, 34.0, 0.0, 9.0, 2.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 4.0, 4.0, 2.0, 3.0, 12.0, 1.0, 1.0, 0.0, 2.0, 0.0, 2.0, 40.0, 6.0, 0.0, 15.0, 5.0, 3.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 1.0, 0.0, 11.0, 4.0, 1.0, 0.0, 12.0, 37.0, 0.0, 1.0, 1.0, 2.0, 0.0, 1.0, 3.0, 3.0, 5.0, 1.0, 3.0, 2.0, 4.0, 1.0, 1.0, 6.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 1.0, 0.0, 6.0, 2.0, 33.0, 8.0, 0.0, 7.0, 0.0, 0.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0.813564</td>\n",
       "      <td>999</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>224.0.0.251</td>\n",
       "      <td>5353</td>\n",
       "      <td>[9.0, 1.0, 13.0, 8.0, 1.0, 65.0, 6.0, 3.0, 7.0, 2.0, 8.0, 2.0, 3.0, 20.0, 1.0, 7.0, 14.0, 30.0, 5.0, 12.0, 1.0, 1.0, 10.0, 6.0, 2.0, 1.0, 18.0, 2.0, 11.0, 32.0, 8.0, 1.0, 2.0, 4.0, 1.0, 1.0, 1.0, 14.0, 17.0, 9.0, 51.0, 2.0, 11.0, 6.0, 3.0, 3.0, 14.0, 1.0, 3.0, 2.0, 1.0, 1.0, 2.0, 8.0, 1.0, 1.0, 1.0, 47.0, 1.0, 3.0, 2.0, 4.0, 1.0, 3.0, 0.0, 1.0, 4.0, 16.0, 4.0, 11.0, 34.0, 6.0, 2.0, 4.0, 1.0, 1.0, 3.0, 13.0, 1.0, 15.0, 5.0, 6.0, 2.0, 1.0, 9.0, 53.0, 11.0, 1.0, 2.0, 1.0, 2.0, 1.0, 31.0, 281.0, 11.0, 2.0, 3.0, 7.0, 10.0, 19.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0.792593</td>\n",
       "      <td>1447</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>224.0.0.252</td>\n",
       "      <td>5355</td>\n",
       "      <td>[1.0, 2.0, 2.0, 16.0, 2.0, 2.0, 12.0, 1.0, 0.0, 2.0, 4.0, 6.0, 35.0, 11.0, 2.0, 2.0, 0.0, 4.0, 18.0, 9.0, 4.0, 0.0, 4.0, 0.0, 11.0, 2.0, 2.0, 15.0, 26.0, 1.0, 5.0, 9.0, 2.0, 1.0, 2.0, 5.0, 1.0, 9.0, 19.0, 1.0, 0.0, 39.0, 0.0, 1.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 6.0, 2.0, 2.0, 4.0, 0.0, 1.0, 0.0, 2.0, 6.0, 0.0, 1.0, 4.0, 4.0, 9.0, 0.0, 2.0, 43.0, 2.0, 0.0, 2.0, 12.0, 6.0, 5.0, 2.0, 0.0, 6.0, 2.0, 0.0, 4.0, 1.0, 0.0, 11.0, 2.0, 41.0, 0.0, 2.0, 2.0, 7.0, 3.0, 6.0, 0.0, 1.0, 0.0, 0.0, 4.0, 4.0, 14.0, 16.0, 32.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0.775758</td>\n",
       "      <td>108</td>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>127.0.0.1</td>\n",
       "      <td>53</td>\n",
       "      <td>[0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 284.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 300.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0.774582</td>\n",
       "      <td>718</td>\n",
       "      <td>192.168.1.202</td>\n",
       "      <td>224.0.0.251</td>\n",
       "      <td>5353</td>\n",
       "      <td>[4.0, 0.0, 2.0, 9.0, 1.0, 4.0, 14.0, 2.0, 9.0, 7.0, 2.0, 0.0, 31.0, 10.0, 1.0, 2.0, 7.0, 19.0, 10.0, 0.0, 2.0, 15.0, 5.0, 39.0, 4.0, 2.0, 18.0, 5.0, 15.0, 3.0, 10.0, 35.0, 5.0, 4.0, 0.0, 24.0, 23.0, 1.0, 53.0, 1.0, 17.0, 5.0, 6.0, 14.0, 1.0, 3.0, 2.0, 2.0, 6.0, 2.0, 0.0, 31.0, 0.0, 7.0, 3.0, 3.0, 2.0, 3.0, 3.0, 7.0, 1.0, 1.0, 1.0, 18.0, 2.0, 4.0, 1.0, 10.0, 0.0, 31.0, 10.0, 2.0, 1.0, 2.0, 4.0, 28.0, 0.0, 1.0, 53.0, 7.0, 2.0, 20.0, 4.0, 3.0, 2.0, 1.0, 19.0, 3.0, 305.0, 21.0, 28.0, 3.0, 0.0, 12.0, 2.0, 2.0, 19.0, 4.0, 4.0, 2.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>0.728111</td>\n",
       "      <td>28</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>184.85.168.170</td>\n",
       "      <td>443</td>\n",
       "      <td>[2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 612.0, 0.0, 904.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0.712963</td>\n",
       "      <td>40</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>138</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 722.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 718.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 722.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 718.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0.710597</td>\n",
       "      <td>114</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.128.25</td>\n",
       "      <td>53</td>\n",
       "      <td>[0.0, 0.0, 0.0, 97.0, 209.0, 1035.0, 36.0, 98.0, 29.0, 74.0, 300.0, 60.0, 120.0, 119.0, 240.0, 284.0, 120.0, 450.0, 0.0, 270.0, 52.0, 0.0, 0.0, 0.0, 0.0, 96.0, 299.0, 0.0, 135.0, 449.0, 135.0, 135.0, 254.0, 75.0, 780.0, 0.0, 759.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 12.0, 29.0, 2.0, 1.0, 27.0, 48.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 97.0, 65.0, 0.0, 298.0, 0.0, 2.0, 0.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0.695213</td>\n",
       "      <td>13</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>184.85.168.170</td>\n",
       "      <td>443</td>\n",
       "      <td>[2.0, 0.0, 0.0, 0.0, 611.0, 129.0, 774.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>0.693369</td>\n",
       "      <td>24</td>\n",
       "      <td>192.168.1.85</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>15600</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2990.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>0.690853</td>\n",
       "      <td>11</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>184.85.168.170</td>\n",
       "      <td>443</td>\n",
       "      <td>[0.0, 0.0, 0.0, 611.0, 129.0, 774.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>0.690778</td>\n",
       "      <td>12</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.128.255</td>\n",
       "      <td>138</td>\n",
       "      <td>[0.0, 0.0, 218.0, 0.0, 0.0, 721.0, 0.0, 0.0, 720.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>0.689791</td>\n",
       "      <td>20</td>\n",
       "      <td>192.168.1.91</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>138</td>\n",
       "      <td>[0.0, 0.0, 0.0, 720.0, 0.0, 0.0, 0.0, 721.0, 0.0, 0.0, 0.0, 721.0, 0.0, 0.0, 0.0, 721.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>0.688331</td>\n",
       "      <td>14</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>40.126.29.9</td>\n",
       "      <td>443</td>\n",
       "      <td>[1.0, 0.0, 1.0, 9.0, 0.0, 44.0, 1.0, 3.0, 0.0, 1.0, 0.0, 74.0, 15.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>0.685814</td>\n",
       "      <td>114</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.120.158</td>\n",
       "      <td>443</td>\n",
       "      <td>[120.0, 120.0, 121.0, 120.0, 120.0, 120.0, 121.0, 120.0, 120.0, 121.0, 120.0, 120.0, 120.0, 120.0, 121.0, 120.0, 5802.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>0.685508</td>\n",
       "      <td>34</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>23.66.101.177</td>\n",
       "      <td>80</td>\n",
       "      <td>[97.0, 5789.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 125.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>0.684705</td>\n",
       "      <td>43</td>\n",
       "      <td>192.168.128.30</td>\n",
       "      <td>192.168.128.25</td>\n",
       "      <td>53</td>\n",
       "      <td>[6118.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 6.0, 158.0, 60.0, 71.0, 0.0, 369.0, 1122.0, 0.0, 23.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>0.684028</td>\n",
       "      <td>15</td>\n",
       "      <td>192.168.128.7</td>\n",
       "      <td>192.168.128.255</td>\n",
       "      <td>138</td>\n",
       "      <td>[0.0, 0.0, 722.0, 0.0, 0.0, 718.0, 0.0, 0.0, 718.0, 0.0, 0.0, 722.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>0.684004</td>\n",
       "      <td>15</td>\n",
       "      <td>192.168.128.11</td>\n",
       "      <td>192.168.128.255</td>\n",
       "      <td>138</td>\n",
       "      <td>[0.0, 0.0, 721.0, 0.0, 0.0, 721.0, 0.0, 0.0, 719.0, 0.0, 0.0, 723.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>0.679376</td>\n",
       "      <td>11</td>\n",
       "      <td>192.168.128.15</td>\n",
       "      <td>192.168.128.255</td>\n",
       "      <td>138</td>\n",
       "      <td>[0.0, 718.0, 0.0, 722.0, 0.0, 722.0, 0.0, 0.0, 723.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>0.676925</td>\n",
       "      <td>20</td>\n",
       "      <td>192.168.128.11</td>\n",
       "      <td>192.168.128.25</td>\n",
       "      <td>88</td>\n",
       "      <td>[233.0, 0.0, 1986.0, 1135.0, 0.0, 0.0, 0.0, 0.0, 419.0, 0.0, 0.0, 0.0, 1020.0, 0.0, 1617.0, 0.0, 0.0, 86.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>0.674770</td>\n",
       "      <td>14</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>192.168.128.25</td>\n",
       "      <td>49666</td>\n",
       "      <td>[0.0, 0.0, 326.0, 0.0, 0.0, 3600.0, 0.0, 1475.0, 0.0, 0.0, 0.0, 0.0, 356.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>0.673147</td>\n",
       "      <td>14</td>\n",
       "      <td>192.168.1.253</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>137</td>\n",
       "      <td>[1801.0, 0.0, 1799.0, 0.0, 0.0, 742.0, 1058.0, 1797.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>0.542385</td>\n",
       "      <td>359</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>192.168.1.181</td>\n",
       "      <td>5044</td>\n",
       "      <td>[15.0, 34.0, 16.0, 9.0, 37.0, 0.0, 21.0, 9.0, 28.0, 21.0, 17.0, 3.0, 41.0, 11.0, 4.0, 4.0, 62.0, 14.0, 29.0, 7.0, 21.0, 0.0, 8.0, 6.0, 1.0, 34.0, 44.0, 7.0, 21.0, 5.0, 8.0, 14.0, 35.0, 8.0, 20.0, 136.0, 27.0, 15.0, 293.0, 16.0, 38.0, 5.0, 25.0, 41.0, 15.0, 1.0, 1.0, 35.0, 13.0, 1.0, 82.0, 15.0, 20.0, 8.0, 5.0, 7.0, 30.0, 13.0, 32.0, 7.0, 27.0, 4.0, 40.0, 15.0, 11.0, 7.0, 25.0, 24.0, 27.0, 5.0, 20.0, 3.0, 5.0, 14.0, 8.0, 12.0, 31.0, 21.0, 7.0, 8.0, 12.0, 40.0, 6.0, 57.0, 8.0, 7.0, 26.0, 37.0, 13.0, 1.0, 5.0, 1.0, 8.0, 28.0, 2.0, 4.0, 2.0, 5.0, 2.0, 6.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>0.442917</td>\n",
       "      <td>102</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>192.168.1.181</td>\n",
       "      <td>5044</td>\n",
       "      <td>[4.0, 10.0, 12.0, 9.0, 18.0, 6.0, 19.0, 0.0, 12.0, 1.0, 42.0, 6.0, 3.0, 1.0, 3.0, 2.0, 18.0, 38.0, 2.0, 4.0, 6.0, 2.0, 2.0, 27.0, 11.0, 14.0, 3.0, 8.0, 6.0, 6.0, 6.0, 12.0, 21.0, 4.0, 17.0, 5.0, 3.0, 19.0, 12.0, 3.0, 8.0, 7.0, 22.0, 118.0, 57.0, 35.0, 52.0, 17.0, 106.0, 25.0, 32.0, 32.0, 11.0, 18.0, 30.0, 59.0, 30.0, 25.0, 19.0, 46.0, 131.0, 2.0, 33.0, 1.0, 14.0, 81.0, 8.0, 27.0, 66.0, 10.0, 63.0, 14.0, 18.0, 15.0, 131.0, 28.0, 26.0, 67.0, 32.0, 16.0, 27.0, 87.0, 51.0, 162.0, 180.0, 1.0, 76.0, 104.0, 27.0, 74.0, 52.0, 27.0, 113.0, 48.0, 19.0, 92.0, 34.0, 111.0, 483.0, 16.0, ...]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     tsScore  conn_count       source.ip   destination.ip destination.port  \\\n",
       "0   1.000000          24   192.168.1.202  255.255.255.255            56700   \n",
       "1   1.000000          31   192.168.1.154    8.240.196.126               80   \n",
       "2   1.000000          24   192.168.1.202  255.255.255.255             9999   \n",
       "3   1.000000          38  192.168.128.15    23.66.101.177               80   \n",
       "4   1.000000          26  192.168.128.50    8.240.196.126               80   \n",
       "5   0.822222        2817   192.168.1.220    192.168.1.255              137   \n",
       "6   0.813564         999   192.168.1.220      224.0.0.251             5353   \n",
       "7   0.792593        1447   192.168.1.220      224.0.0.252             5355   \n",
       "8   0.775758         108       127.0.0.1        127.0.0.1               53   \n",
       "9   0.774582         718   192.168.1.202      224.0.0.251             5353   \n",
       "10  0.728111          28   192.168.1.154   184.85.168.170              443   \n",
       "11  0.712963          40   192.168.1.220    192.168.1.255              138   \n",
       "12  0.710597         114  192.168.128.50   192.168.128.25               53   \n",
       "13  0.695213          13   192.168.1.154   184.85.168.170              443   \n",
       "14  0.693369          24    192.168.1.85    192.168.1.255            15600   \n",
       "15  0.690853          11  192.168.128.50   184.85.168.170              443   \n",
       "16  0.690778          12  192.168.128.50  192.168.128.255              138   \n",
       "17  0.689791          20    192.168.1.91    192.168.1.255              138   \n",
       "18  0.688331          14   192.168.1.154      40.126.29.9              443   \n",
       "19  0.685814         114  192.168.128.50  192.168.120.158              443   \n",
       "20  0.685508          34   192.168.1.154    23.66.101.177               80   \n",
       "21  0.684705          43  192.168.128.30   192.168.128.25               53   \n",
       "22  0.684028          15   192.168.128.7  192.168.128.255              138   \n",
       "23  0.684004          15  192.168.128.11  192.168.128.255              138   \n",
       "24  0.679376          11  192.168.128.15  192.168.128.255              138   \n",
       "25  0.676925          20  192.168.128.11   192.168.128.25               88   \n",
       "26  0.674770          14  192.168.128.50   192.168.128.25            49666   \n",
       "27  0.673147          14   192.168.1.253    192.168.1.255              137   \n",
       "28  0.542385         359   192.168.1.154    192.168.1.181             5044   \n",
       "29  0.442917         102   192.168.1.154    192.168.1.181             5044   \n",
       "\n",
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     deltas  \n",
       "0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "1                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "3                                                                                                                                                                                                                                                                                                                                                                                                                                 [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             [0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "5                                                                                        [1.0, 0.0, 1.0, 1.0, 1.0, 6.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 11.0, 3.0, 0.0, 0.0, 5.0, 6.0, 34.0, 0.0, 9.0, 2.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 4.0, 4.0, 2.0, 3.0, 12.0, 1.0, 1.0, 0.0, 2.0, 0.0, 2.0, 40.0, 6.0, 0.0, 15.0, 5.0, 3.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 1.0, 0.0, 11.0, 4.0, 1.0, 0.0, 12.0, 37.0, 0.0, 1.0, 1.0, 2.0, 0.0, 1.0, 3.0, 3.0, 5.0, 1.0, 3.0, 2.0, 4.0, 1.0, 1.0, 6.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 1.0, 0.0, 6.0, 2.0, 33.0, 8.0, 0.0, 7.0, 0.0, 0.0, ...]  \n",
       "6                                                                    [9.0, 1.0, 13.0, 8.0, 1.0, 65.0, 6.0, 3.0, 7.0, 2.0, 8.0, 2.0, 3.0, 20.0, 1.0, 7.0, 14.0, 30.0, 5.0, 12.0, 1.0, 1.0, 10.0, 6.0, 2.0, 1.0, 18.0, 2.0, 11.0, 32.0, 8.0, 1.0, 2.0, 4.0, 1.0, 1.0, 1.0, 14.0, 17.0, 9.0, 51.0, 2.0, 11.0, 6.0, 3.0, 3.0, 14.0, 1.0, 3.0, 2.0, 1.0, 1.0, 2.0, 8.0, 1.0, 1.0, 1.0, 47.0, 1.0, 3.0, 2.0, 4.0, 1.0, 3.0, 0.0, 1.0, 4.0, 16.0, 4.0, 11.0, 34.0, 6.0, 2.0, 4.0, 1.0, 1.0, 3.0, 13.0, 1.0, 15.0, 5.0, 6.0, 2.0, 1.0, 9.0, 53.0, 11.0, 1.0, 2.0, 1.0, 2.0, 1.0, 31.0, 281.0, 11.0, 2.0, 3.0, 7.0, 10.0, 19.0, ...]  \n",
       "7                                                                                [1.0, 2.0, 2.0, 16.0, 2.0, 2.0, 12.0, 1.0, 0.0, 2.0, 4.0, 6.0, 35.0, 11.0, 2.0, 2.0, 0.0, 4.0, 18.0, 9.0, 4.0, 0.0, 4.0, 0.0, 11.0, 2.0, 2.0, 15.0, 26.0, 1.0, 5.0, 9.0, 2.0, 1.0, 2.0, 5.0, 1.0, 9.0, 19.0, 1.0, 0.0, 39.0, 0.0, 1.0, 0.0, 2.0, 2.0, 0.0, 2.0, 2.0, 2.0, 6.0, 2.0, 2.0, 4.0, 0.0, 1.0, 0.0, 2.0, 6.0, 0.0, 1.0, 4.0, 4.0, 9.0, 0.0, 2.0, 43.0, 2.0, 0.0, 2.0, 12.0, 6.0, 5.0, 2.0, 0.0, 6.0, 2.0, 0.0, 4.0, 1.0, 0.0, 11.0, 2.0, 41.0, 0.0, 2.0, 2.0, 7.0, 3.0, 6.0, 0.0, 1.0, 0.0, 0.0, 4.0, 4.0, 14.0, 16.0, 32.0, ...]  \n",
       "8                                                                          [0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 284.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 300.0, ...]  \n",
       "9                                                                  [4.0, 0.0, 2.0, 9.0, 1.0, 4.0, 14.0, 2.0, 9.0, 7.0, 2.0, 0.0, 31.0, 10.0, 1.0, 2.0, 7.0, 19.0, 10.0, 0.0, 2.0, 15.0, 5.0, 39.0, 4.0, 2.0, 18.0, 5.0, 15.0, 3.0, 10.0, 35.0, 5.0, 4.0, 0.0, 24.0, 23.0, 1.0, 53.0, 1.0, 17.0, 5.0, 6.0, 14.0, 1.0, 3.0, 2.0, 2.0, 6.0, 2.0, 0.0, 31.0, 0.0, 7.0, 3.0, 3.0, 2.0, 3.0, 3.0, 7.0, 1.0, 1.0, 1.0, 18.0, 2.0, 4.0, 1.0, 10.0, 0.0, 31.0, 10.0, 2.0, 1.0, 2.0, 4.0, 28.0, 0.0, 1.0, 53.0, 7.0, 2.0, 20.0, 4.0, 3.0, 2.0, 1.0, 19.0, 3.0, 305.0, 21.0, 28.0, 3.0, 0.0, 12.0, 2.0, 2.0, 19.0, 4.0, 4.0, 2.0, ...]  \n",
       "10                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 612.0, 0.0, 904.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "11                                                                                                                                                                                                                                                                                                                                                                                                              [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 722.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 718.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 722.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 718.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "12                                         [0.0, 0.0, 0.0, 97.0, 209.0, 1035.0, 36.0, 98.0, 29.0, 74.0, 300.0, 60.0, 120.0, 119.0, 240.0, 284.0, 120.0, 450.0, 0.0, 270.0, 52.0, 0.0, 0.0, 0.0, 0.0, 96.0, 299.0, 0.0, 135.0, 449.0, 135.0, 135.0, 254.0, 75.0, 780.0, 0.0, 759.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 12.0, 29.0, 2.0, 1.0, 27.0, 48.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 97.0, 65.0, 0.0, 298.0, 0.0, 2.0, 0.0, ...]  \n",
       "13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [2.0, 0.0, 0.0, 0.0, 611.0, 129.0, 774.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2990.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 [0.0, 0.0, 0.0, 611.0, 129.0, 774.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [0.0, 0.0, 218.0, 0.0, 0.0, 721.0, 0.0, 0.0, 720.0, 0.0, 0.0]  \n",
       "17                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [0.0, 0.0, 0.0, 720.0, 0.0, 0.0, 0.0, 721.0, 0.0, 0.0, 0.0, 721.0, 0.0, 0.0, 0.0, 721.0, 0.0, 0.0, 0.0]  \n",
       "18                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [1.0, 0.0, 1.0, 9.0, 0.0, 44.0, 1.0, 3.0, 0.0, 1.0, 0.0, 74.0, 15.0]  \n",
       "19  [120.0, 120.0, 121.0, 120.0, 120.0, 120.0, 121.0, 120.0, 120.0, 121.0, 120.0, 120.0, 120.0, 120.0, 121.0, 120.0, 5802.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0,...  \n",
       "20                                                                                                                                                                                                                                                                                                                                                                                                                                              [97.0, 5789.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 125.0, 0.0]  \n",
       "21                                                                                                                                                                                                                                                                                                                                                                                          [6118.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 2.0, 6.0, 158.0, 60.0, 71.0, 0.0, 369.0, 1122.0, 0.0, 23.0, 0.0]  \n",
       "22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [0.0, 0.0, 722.0, 0.0, 0.0, 718.0, 0.0, 0.0, 718.0, 0.0, 0.0, 722.0, 0.0, 0.0]  \n",
       "23                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [0.0, 0.0, 721.0, 0.0, 0.0, 721.0, 0.0, 0.0, 719.0, 0.0, 0.0, 723.0, 0.0, 0.0]  \n",
       "24                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               [0.0, 718.0, 0.0, 722.0, 0.0, 722.0, 0.0, 0.0, 723.0, 0.0]  \n",
       "25                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         [233.0, 0.0, 1986.0, 1135.0, 0.0, 0.0, 0.0, 0.0, 419.0, 0.0, 0.0, 0.0, 1020.0, 0.0, 1617.0, 0.0, 0.0, 86.0, 0.0]  \n",
       "26                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [0.0, 0.0, 326.0, 0.0, 0.0, 3600.0, 0.0, 1475.0, 0.0, 0.0, 0.0, 0.0, 356.0]  \n",
       "27                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [1801.0, 0.0, 1799.0, 0.0, 0.0, 742.0, 1058.0, 1797.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "28                                      [15.0, 34.0, 16.0, 9.0, 37.0, 0.0, 21.0, 9.0, 28.0, 21.0, 17.0, 3.0, 41.0, 11.0, 4.0, 4.0, 62.0, 14.0, 29.0, 7.0, 21.0, 0.0, 8.0, 6.0, 1.0, 34.0, 44.0, 7.0, 21.0, 5.0, 8.0, 14.0, 35.0, 8.0, 20.0, 136.0, 27.0, 15.0, 293.0, 16.0, 38.0, 5.0, 25.0, 41.0, 15.0, 1.0, 1.0, 35.0, 13.0, 1.0, 82.0, 15.0, 20.0, 8.0, 5.0, 7.0, 30.0, 13.0, 32.0, 7.0, 27.0, 4.0, 40.0, 15.0, 11.0, 7.0, 25.0, 24.0, 27.0, 5.0, 20.0, 3.0, 5.0, 14.0, 8.0, 12.0, 31.0, 21.0, 7.0, 8.0, 12.0, 40.0, 6.0, 57.0, 8.0, 7.0, 26.0, 37.0, 13.0, 1.0, 5.0, 1.0, 8.0, 28.0, 2.0, 4.0, 2.0, 5.0, 2.0, 6.0, ...]  \n",
       "29                [4.0, 10.0, 12.0, 9.0, 18.0, 6.0, 19.0, 0.0, 12.0, 1.0, 42.0, 6.0, 3.0, 1.0, 3.0, 2.0, 18.0, 38.0, 2.0, 4.0, 6.0, 2.0, 2.0, 27.0, 11.0, 14.0, 3.0, 8.0, 6.0, 6.0, 6.0, 12.0, 21.0, 4.0, 17.0, 5.0, 3.0, 19.0, 12.0, 3.0, 8.0, 7.0, 22.0, 118.0, 57.0, 35.0, 52.0, 17.0, 106.0, 25.0, 32.0, 32.0, 11.0, 18.0, 30.0, 59.0, 30.0, 25.0, 19.0, 46.0, 131.0, 2.0, 33.0, 1.0, 14.0, 81.0, 8.0, 27.0, 66.0, 10.0, 63.0, 14.0, 18.0, 15.0, 131.0, 28.0, 26.0, 67.0, 32.0, 16.0, 27.0, 87.0, 51.0, 162.0, 180.0, 1.0, 76.0, 104.0, 27.0, 74.0, 52.0, 27.0, 113.0, 48.0, 19.0, 92.0, 34.0, 111.0, 483.0, 16.0, ...]  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['tsSkewScore'] = 1.0 - abs(df['tsSkew'])\n",
    "df['tsMadmScore'] = 1.0 - df['tsMadm']/30.0\n",
    "df['tsMadmScore'] = df['tsMadmScore'].apply(lambda x: 0 if x < 0 else x)\n",
    "df['tsConnCountScore'] = (df['conn_count']) / df['tsConnDiv']\n",
    "df['tsConnCountScore'] = df['tsConnCountScore'].apply(lambda x: 1.0 if x > 1.0 else x)\n",
    "df['tsScore'] = (((df['tsSkewScore'] + df['tsMadmScore'] + df['tsConnCountScore']) / 3.0) * 1000) / 1000\n",
    "df.sort_values(by= 'tsScore', ascending=False, inplace=True, ignore_index=True)\n",
    "df[columns_to_display].head(30)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "0679eb56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tsScore</th>\n",
       "      <th>conn_count</th>\n",
       "      <th>source.ip</th>\n",
       "      <th>destination.ip</th>\n",
       "      <th>destination.port</th>\n",
       "      <th>deltas</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>24</td>\n",
       "      <td>192.168.1.202</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>56700</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>31</td>\n",
       "      <td>192.168.1.154</td>\n",
       "      <td>8.240.196.126</td>\n",
       "      <td>80</td>\n",
       "      <td>[0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>24</td>\n",
       "      <td>192.168.1.202</td>\n",
       "      <td>255.255.255.255</td>\n",
       "      <td>9999</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>38</td>\n",
       "      <td>192.168.128.15</td>\n",
       "      <td>23.66.101.177</td>\n",
       "      <td>80</td>\n",
       "      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>26</td>\n",
       "      <td>192.168.128.50</td>\n",
       "      <td>8.240.196.126</td>\n",
       "      <td>80</td>\n",
       "      <td>[0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0.822222</td>\n",
       "      <td>2817</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>192.168.1.255</td>\n",
       "      <td>137</td>\n",
       "      <td>[1.0, 0.0, 1.0, 1.0, 1.0, 6.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 11.0, 3.0, 0.0, 0.0, 5.0, 6.0, 34.0, 0.0, 9.0, 2.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 4.0, 4.0, 2.0, 3.0, 12.0, 1.0, 1.0, 0.0, 2.0, 0.0, 2.0, 40.0, 6.0, 0.0, 15.0, 5.0, 3.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 1.0, 0.0, 11.0, 4.0, 1.0, 0.0, 12.0, 37.0, 0.0, 1.0, 1.0, 2.0, 0.0, 1.0, 3.0, 3.0, 5.0, 1.0, 3.0, 2.0, 4.0, 1.0, 1.0, 6.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 1.0, 0.0, 6.0, 2.0, 33.0, 8.0, 0.0, 7.0, 0.0, 0.0, ...]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0.813564</td>\n",
       "      <td>999</td>\n",
       "      <td>192.168.1.220</td>\n",
       "      <td>224.0.0.251</td>\n",
       "      <td>5353</td>\n",
       "      <td>[9.0, 1.0, 13.0, 8.0, 1.0, 65.0, 6.0, 3.0, 7.0, 2.0, 8.0, 2.0, 3.0, 20.0, 1.0, 7.0, 14.0, 30.0, 5.0, 12.0, 1.0, 1.0, 10.0, 6.0, 2.0, 1.0, 18.0, 2.0, 11.0, 32.0, 8.0, 1.0, 2.0, 4.0, 1.0, 1.0, 1.0, 14.0, 17.0, 9.0, 51.0, 2.0, 11.0, 6.0, 3.0, 3.0, 14.0, 1.0, 3.0, 2.0, 1.0, 1.0, 2.0, 8.0, 1.0, 1.0, 1.0, 47.0, 1.0, 3.0, 2.0, 4.0, 1.0, 3.0, 0.0, 1.0, 4.0, 16.0, 4.0, 11.0, 34.0, 6.0, 2.0, 4.0, 1.0, 1.0, 3.0, 13.0, 1.0, 15.0, 5.0, 6.0, 2.0, 1.0, 9.0, 53.0, 11.0, 1.0, 2.0, 1.0, 2.0, 1.0, 31.0, 281.0, 11.0, 2.0, 3.0, 7.0, 10.0, 19.0, ...]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    tsScore  conn_count       source.ip   destination.ip destination.port  \\\n",
       "0  1.000000          24   192.168.1.202  255.255.255.255            56700   \n",
       "1  1.000000          31   192.168.1.154    8.240.196.126               80   \n",
       "2  1.000000          24   192.168.1.202  255.255.255.255             9999   \n",
       "3  1.000000          38  192.168.128.15    23.66.101.177               80   \n",
       "4  1.000000          26  192.168.128.50    8.240.196.126               80   \n",
       "5  0.822222        2817   192.168.1.220    192.168.1.255              137   \n",
       "6  0.813564         999   192.168.1.220      224.0.0.251             5353   \n",
       "\n",
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   deltas  \n",
       "0                                                                                                                                                                                                                                                                                                                                                                                                                                     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "1                                                                                                                                                                                                                                                                                                                                                                                                  [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "2                                                                                                                                                                                                                                                                                                                                                                                                                                     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "3                                                                                                                                                                                                                                                                                                                                                               [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "4                                                                                                                                                                                                                                                                                                                                                                                                                           [0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  \n",
       "5                      [1.0, 0.0, 1.0, 1.0, 1.0, 6.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 11.0, 3.0, 0.0, 0.0, 5.0, 6.0, 34.0, 0.0, 9.0, 2.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 4.0, 4.0, 2.0, 3.0, 12.0, 1.0, 1.0, 0.0, 2.0, 0.0, 2.0, 40.0, 6.0, 0.0, 15.0, 5.0, 3.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 1.0, 0.0, 11.0, 4.0, 1.0, 0.0, 12.0, 37.0, 0.0, 1.0, 1.0, 2.0, 0.0, 1.0, 3.0, 3.0, 5.0, 1.0, 3.0, 2.0, 4.0, 1.0, 1.0, 6.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 1.0, 0.0, 6.0, 2.0, 33.0, 8.0, 0.0, 7.0, 0.0, 0.0, ...]  \n",
       "6  [9.0, 1.0, 13.0, 8.0, 1.0, 65.0, 6.0, 3.0, 7.0, 2.0, 8.0, 2.0, 3.0, 20.0, 1.0, 7.0, 14.0, 30.0, 5.0, 12.0, 1.0, 1.0, 10.0, 6.0, 2.0, 1.0, 18.0, 2.0, 11.0, 32.0, 8.0, 1.0, 2.0, 4.0, 1.0, 1.0, 1.0, 14.0, 17.0, 9.0, 51.0, 2.0, 11.0, 6.0, 3.0, 3.0, 14.0, 1.0, 3.0, 2.0, 1.0, 1.0, 2.0, 8.0, 1.0, 1.0, 1.0, 47.0, 1.0, 3.0, 2.0, 4.0, 1.0, 3.0, 0.0, 1.0, 4.0, 16.0, 4.0, 11.0, 34.0, 6.0, 2.0, 4.0, 1.0, 1.0, 3.0, 13.0, 1.0, 15.0, 5.0, 6.0, 2.0, 1.0, 9.0, 53.0, 11.0, 1.0, 2.0, 1.0, 2.0, 1.0, 31.0, 281.0, 11.0, 2.0, 3.0, 7.0, 10.0, 19.0, ...]  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.loc[df['tsScore'] > 0.80, columns_to_display]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c225665a",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed23122f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
